(window.webpackJsonp=window.webpackJsonp||[]).push([["modules/stickyads"],{"25198250de57e9ac2bf1":function(t,e,i){"use strict";i.r(e),i.d(e,"getScrollTop",function(){return f}),i.d(e,"hasLeadVideo",function(){return g}),i.d(e,"Ad",function(){return y}),i.d(e,"StickyAds",function(){return p});var o=i("8d0684f10c3cea737a13"),r=i("891a19eb7d3552f95f46"),s=i("654adc4d2d3e5dbaee18");function l(t){return function(t){if(Array.isArray(t)){for(var e=0,i=new Array(t.length);e<t.length;e++)i[e]=t[e];return i}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function c(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}var u=[".article-breaker-ad:not(.mobile-breaker-ad)",".listicle-slide-list-ad"].join(","),d=".content-rail",h="".concat(d,", .right-rail-ad"),f=function(){return window.pageYOffset},g=function(){return null!==document.querySelector(".content-lede-video [data-sticky=true]")},y=function(){function e(t){a(this,e),this.el=t,this.storeParent(),this.fixedToTop=!0,this.fixedToBottom=!1}return c(e,[{key:"fix",value:function(){var t=this.el.getBoundingClientRect().left,e=document.body.clientWidth-(this.el.offsetWidth+t),i=["position: fixed","top: ".concat(90,"px"),"right: ".concat(e,"px"),"width: auto"].join(";");this.storeParent(),this.el.style.cssText=i,this.fixedToTop=!1,this.fixedToBottom=!1}},{key:"fixToBottom",value:function(t){var e=t-(f()+this.parent.getBoundingClientRect().top);this.el.style.cssText="position: absolute; top: ".concat(e,"px; right:40px;"),this.fixedToBottom=!0}},{key:"unfix",value:function(){this.el.style.cssText="",this.fixedToTop=!0}},{key:"storeParent",value:function(){this.parent=this.el.offsetParent}}]),e}(),p=function(){function n(t){var e=this;a(this,n),this.ads=[],this.el=t,this.fixed=!1,this.scrollTracking=!1,this.lastScrollY=f(),this.logger=new r.a("StickyAds"),this.registerAds(this.el.querySelectorAll(h)),this.observer=Object(s.u)(this.el,this.handleMutation.bind(this),{childList:!0,subtree:!0}),window.addEventListener("glimmer.sticky",function(){return e.handleStickyVideo()}),window.addEventListener("glimmer.unsticky",function(){return e.handleUnstickyVideo()}),this.startScrollTracking()}return c(n,null,[{key:"setup",value:function(t){var e=0<arguments.length&&void 0!==t?t:{},i=document.querySelector(e.selector||".content-container");return!i||Modernizr.mobile||Modernizr.tablet||g()?null:new n(i)}}]),c(n,[{key:"handleMutation",value:function(t){var e=l(t.addedNodes).filter(function(t){return t instanceof Element&&t.matches(h)});e.length&&this.registerAds(e)}},{key:"handleScroll",value:function(t){var e=t>this.lastScrollY?"down":"up";if(this.lastScrollY=t,this.fixed){var i=this.fixed.el;if("down"==e){var n=this.getLowerBoundary(i);n<=t+90&&(this.fixed.fixToBottom(n),this.fixed=null)}else t+90<=this.getUpperBoundary(i)&&(this.fixed.unfix(),this.fixed=null)}else this.checkForAdsToFix(e)}},{key:"handleStickyVideo",value:function(){this.stopScrollTracking();for(var t=0,e=this.ads.length;t<e;t+=1)this.ads[t].unfix();this.fixed=null}},{key:"handleUnstickyVideo",value:function(){this.startScrollTracking()}},{key:"startScrollTracking",value:function(){o.a.on("scroll",this.handleScroll.bind(this),"sticky-ads"),this.scrollTracking=!0}},{key:"stopScrollTracking",value:function(){o.a.off("scroll","sticky-ads"),this.scrollTracking=!1}},{key:"checkForAdsToFix",value:function(t){for(var e=0,i=this.ads.length;e<i;e+=1){var n=this.ads[e],o=n.el,r=o.getBoundingClientRect(),s=r.bottom,l=r.top;if(0<s&&l<window.innerHeight){if("down"===t?l<=90&&!n.fixedToBottom&&this.getLowerBoundary(o)>this.getUpperBoundary(o):90<=l&&!n.fixedToTop)return n.fix(),void(this.fixed=n)}}}},{key:"registerAds",value:function(t){var e=this;l(t).forEach(function(t){return e.ads.push(new y(t))}),this.logger.log("regiserted new ads",t,this.ads),this.ads.sort(function(t,e){var i=t.el.getBoundingClientRect().top,n=e.el.getBoundingClientRect().top;return n<i?1:i<n?-1:0})}},{key:"getLowerBoundary",value:function(t){var e,i=t.matches(d)?this.el.querySelector(u):Object(s.o)(t,u);return e=i?i.getBoundingClientRect().top:this.el.getBoundingClientRect().bottom,(e+=f())-t.getBoundingClientRect().height-window.innerHeight}},{key:"getUpperBoundary",value:function(t){var e,i=Object(s.r)(t,u);return e=i?i.getBoundingClientRect().bottom+20:this.el.getBoundingClientRect().top,f()+e}}]),n}()}}]);
//# sourceMappingURL=stickyads.3f16cb6.js.map